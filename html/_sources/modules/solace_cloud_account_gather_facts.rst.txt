:github_url: https://github.com/solace-iot-team/ansible-solace-collection/tree/main/src/ansible_collections/solace/pubsub_plus/plugins/modules/solace_cloud_account_gather_facts.py

.. _solace_cloud_account_gather_facts_module:

solace_cloud_account_gather_facts -- gather account services facts
==================================================================

Retrieves service info (facts) about all services available in the Solace Cloud Account.

For example, use to retrieve the SEMP endpoints for a Solace Cloud service as inputs for other modules.




Examples
--------

.. code-block:: yaml+jinja

   
   hosts: all
   gather_facts: no
   any_errors_fatal: true
   collections:
   - solace.pubsub_plus
   tasks:
   - name: "Solace Cloud Account: Gather Facts as Dict"
     solace_cloud_account_gather_facts:
       api_token: "{{ api_token }}"
       account_name: "{{ inventory_hostname }}"
       return_format: dict
     register: result

   - name: "Save Facts dict: Solace Cloud Account"
     copy:
       content: "{{ result | to_nice_json }}"
       dest: "./tmp/facts.dict.solace_cloud_account.{{ inventory_hostname }}.json"
     delegate_to: localhost

   - name: "Set Fact as Dict: Solace Cloud Account Services"
     set_fact:
       dict_facts: "{{ result.ansible_facts.solace_cloud_accounts[inventory_hostname].services }}"

   - name: "Solace Cloud Account: Gather Facts as List"
     solace_cloud_account_gather_facts:
       api_token: "{{ api_token }}"
       account_name: "{{ inventory_hostname }}"
       return_format: list
     register: result

   - name: "Save Facts List: Solace Cloud Account"
     copy:
       content: "{{ result | to_nice_json }}"
       dest: "./tmp/facts.list.solace_cloud_account.{{ inventory_hostname }}.json"
     delegate_to: localhost

   - name: "Set Fact as List: Solace Cloud Account Services"
     set_fact:
       list_facts: "{{ result.ansible_facts.solace_cloud_accounts[inventory_hostname].services }}"

   - name: "Loop: Get Service Info for all Services By serviceId"
     solace_cloud_get_service:
       api_token: "{{ api_token }}"
       service_id: "{{ sc_service.serviceId }}"
     loop: "{{ list_facts }}"
     loop_control:
       loop_var: service
       label: "[by serviceId] Service: name={{ service.name }}, id={{ service.serviceId }}"



Notes
-----

.. note::
   - Module Solace Cloud API: https://docs.solace.com/Solace-Cloud/ght_use_rest_api_services.htm


See Also
--------

.. seealso::

   - :ref:`solace_cloud_get_facts_module`
   - :ref:`solace_get_facts_module`



Parameters
----------

account_name (required)
  The host specified in the inventory. Represents the Solace Cloud Account.

  Note: Only used internally in the playbooks, so you can choose whichever name makes sense in your case.

  | **type**: str
  | **aliases**: name

return_format (required)
  The format of the returned JSON. Either as a JSON object or a JSON array.

  Note: Use 'dict' when you want to access the facts in a playbook by account_name (i.e. 'inventory_hostname') directly.

  Note: Use 'list' when you want to iterate over each service in your playbook.

  | **type**: str
  | **choices**: dict, list

solace_cloud_api_token (required)
  The API Token.

  Generate using Solace Cloud console with the appropriate permissions for the operations you want to enable.

  | **type**: str
  | **aliases**: api_token

solace_cloud_home (optional)
  The Solace Cloud home region.

  | **type**: str
  | **choices**: us, au, US, AU, 

timeout (optional)
  Connection timeout in seconds for the http request or overall call interaction timeout for Solace Cloud API.

  | **type**: int
  | **default**: 60

validate_certs (optional)
  Flag to switch validation of client certificates on/off when using a secure connection.

  | **type**: bool
  | **default**: True





Return Values
-------------

solace_cloud_account
  Contains the info from the Solace Cloud account by {_account_name_}.

  | **returned**: success
  | **type**: dict
  | **sample**:

  .. code-block:: json

     {
     "solace_cloud_account": {
       "_account_name_": {
         "data_centers": {
           "_data_center_id_1_": "... data center info ...",
           "_data_center_id_2_": "... data center info ..."
         },
         "services": {
           "_service_name_1_": "... service info  ...",
           "_service_name_2_": "... service info  ..."
         }
       }
     }
   }

msg
  The response from the HTTP call in case of error.

  | **returned**: error
  | **type**: dict

rc
  Return code. rc=0 on success, rc=1 on error.

  | **returned**: always
  | **type**: int
  | **sample**:

  .. code-block:: json

     {
     "error": {
       "rc": 1
     },
     "success": {
       "rc": 0
     }
   }


