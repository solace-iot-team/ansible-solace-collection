:github_url: https://github.com/solace-iot-team/ansible-solace-collection/tree/main/src/ansible_collections/solace/pubsub_plus/plugins/modules/solace_queue_subscriptions.py

.. _solace_queue_subscriptions_module:

solace_queue_subscriptions -- list of subscriptions on a queue
==============================================================

Configure a list of Subscription objects on a Queue in a single transaction.

Allows addition and removal of a list of Subscription objects as well as replacement of all existing Subscription objects on a queue.

Supports 'transactional' behavior with rollback to original list in case of error.

De-duplicates Subscription object list.

Reports which topics were added, deleted and omitted (duplicates). In case of an error, reports the invalid Subscription object.

To delete all Subscription objects, use state='exactly' with an empty/null list (see examples).




Examples
--------

.. code-block:: yaml+jinja

   
     hosts: all
     gather_facts: no
     any_errors_fatal: true
     collections:
       - solace.pubsub_plus
     module_defaults:
       solace_queue:
         host: "{{ sempv2_host }}"
         port: "{{ sempv2_port }}"
         secure_connection: "{{ sempv2_is_secure_connection }}"
         username: "{{ sempv2_username }}"
         password: "{{ sempv2_password }}"
         timeout: "{{ sempv2_timeout }}"
         msg_vpn: "{{ vpn }}"
         reverse_proxy: "{{ semp_reverse_proxy | default(omit) }}"
       solace_queue_subscriptions:
         host: "{{ sempv2_host }}"
         port: "{{ sempv2_port }}"
         secure_connection: "{{ sempv2_is_secure_connection }}"
         username: "{{ sempv2_username }}"
         password: "{{ sempv2_password }}"
         timeout: "{{ sempv2_timeout }}"
         msg_vpn: "{{ vpn }}"
         reverse_proxy: "{{ semp_reverse_proxy | default(omit) }}"
       solace_get_queue_subscriptions:
         host: "{{ sempv2_host }}"
         port: "{{ sempv2_port }}"
         secure_connection: "{{ sempv2_is_secure_connection }}"
         username: "{{ sempv2_username }}"
         password: "{{ sempv2_password }}"
         timeout: "{{ sempv2_timeout }}"
         msg_vpn: "{{ vpn }}"
         reverse_proxy: "{{ semp_reverse_proxy | default(omit) }}"
     tasks:
     - name: create queue
       solace_queue:
         name: q/foo
         state: present

     - name: add list of subscriptions
       solace_queue_subscriptions:
         queue_name: q/foo
         subscription_topics:
           - topic-1
           - topic-2
         state: present

     - name: get subscriptions
       solace_get_queue_subscriptions:
         queue_name: q/foo

     - name: add second list of subscriptions
       solace_queue_subscriptions:
         queue_name: q/foo
         subscription_topics:
           - topic-3
           - topic-4
         state: present

     - name: get subscriptions
       solace_get_queue_subscriptions:
         queue_name: q/foo

     - name: replace subscriptions
       solace_queue_subscriptions:
         queue_name: q/foo
         subscription_topics:
           - new-topic-1
           - new-topic-2
         state: exactly

     - name: get subscriptions
       solace_get_queue_subscriptions:
         queue_name: q/foo

     - name: handle duplicate subscriptions
       solace_queue_subscriptions:
         queue_name: q/foo
         subscription_topics:
           - duplicate-topic
           - duplicate-topic
         state: exactly

     - name: get subscriptions
       solace_get_queue_subscriptions:
         queue_name: q/foo

     - name: delete all subscriptions
       solace_queue_subscriptions:
         queue_name: q/foo
         subscription_topics: null
         state: exactly

     - name: get subscriptions
       solace_get_queue_subscriptions:
         queue_name: q/foo



Notes
-----

.. note::
   - Module Sempv2 Config: https://docs.solace.com/API-Developer-Online-Ref-Documentation/swagger-ui/config/index.html#/queue/createMsgVpnQueueSubscription
   - Sempv2 Config Reference: https://docs.solace.com/API-Developer-Online-Ref-Documentation/swagger-ui/config/index.html#/
   - Sempv2 Monitor Reference: https://docs.solace.com/API-Developer-Online-Ref-Documentation/swagger-ui/monitor/index.html#/
   - Sempv2 Action Reference: https://docs.solace.com/API-Developer-Online-Ref-Documentation/swagger-ui/action/index.html#/


See Also
--------

.. seealso::

   - :ref:`solace_queue_module`
   - :ref:`solace_queue_subscription_module`
   - :ref:`solace_get_queue_subscriptions_module`



Parameters
----------

host (optional)
  Hostname of Solace Broker.

  | **type**: str
  | **default**: localhost

msg_vpn (required)
  The message vpn.

  | **type**: str

names (required)
  The subscription topic. Maps to 'subscriptionTopic' in the SEMP v2 API.

  | **type**: list
  | **aliases**: topics, subscription_topics

password (optional)
  Administrator password for Solace Broker.

  | **type**: str
  | **default**: admin

port (optional)
  Management port of Solace Broker.

  | **type**: int
  | **default**: 8080

queue (required)
  The queue. Maps to 'queueName' in the API.

  | **type**: str
  | **aliases**: queue_name

reverse_proxy (optional)
  Use a reverse proxy / api gateway. Note: **Experimental. Not permitted for Solace Cloud API**.

  | **type**: dict

  headers (optional)
    Additional headers to add to the http call. Example: 'apiKey: {my-api-key}'.

    | **type**: dict

    x-asc-module (optional)
      Flag for the module to add the header 'x-asc-module:{module-name}' to the http call with it's module name.

      | **type**: bool
      | **default**: False

    x-asc-module-op (optional)
      Flag for the module to add the header 'x-asc-module-op:{module operation}' to the http call with the module's operation.

      | **type**: bool
      | **default**: False


  query_params (optional)
    Additional query paramters to add to the URL. Example: 'apiCode: {my-api-code}'.

    | **type**: dict

  semp_base_path (optional)
    Base path prepended to all SEMP calls. Example: 'my/base/path'. Resulting URL will be: http(s)://{host}:{port}/{semp_base_path}/{module-semp-call-path}

    | **type**: str

  use_basic_auth (optional)
    Flag to use basic authentication in the http(s) call or not. Uses 'username'/'password'.

    | **type**: bool
    | **default**: False


secure_connection (optional)
  If true, use https rather than http.

  | **type**: bool
  | **default**: False

sempv2_settings (optional)
  JSON dictionary of additional configuration for the SEMP V2 API. See Reference documentation.

  | **type**: dict
  | **aliases**: settings

state (optional)
  Target state for CRUD list operation.

  | **type**: str
  | **default**: present
  | **choices**: present, absent, exactly

timeout (optional)
  Connection timeout in seconds for the http request.

  | **type**: int
  | **default**: 10

username (optional)
  Administrator username for Solace Broker.

  | **type**: str
  | **default**: admin

x_broker (optional)
  Custom HTTP header with the broker virtual router id, if using a SEMPv2 Proxy/agent infrastructure.

  | **type**: str





Return Values
-------------

response
  The response of the operation.

  | **returned**: always
  | **type**: dict
  | **sample**:

  .. code-block:: json

     {
     "error": {
       "response": [
         {
           "error": "/invalid-topic"
         }
       ]
     },
     "success": {
       "response": [
         {
           "added": "topic-6"
         },
         {
           "added": "topic-7"
         },
         {
           "added": "duplicate-topic"
         },
         {
           "deleted": "topic-1"
         },
         {
           "deleted": "topic-2"
         },
         {
           "deleted": "topic-3"
         },
         {
           "deleted": "topic-4"
         },
         {
           "deleted": "topic-5"
         },
         {
           "duplicate": "duplicate-topic"
         }
       ]
     }
   }

msg
  The response from the HTTP call in case of error.

  | **returned**: error
  | **type**: dict

rc
  Return code. rc=0 on success, rc=1 on error.

  | **returned**: always
  | **type**: int
  | **sample**:

  .. code-block:: json

     {
     "error": {
       "rc": 1
     },
     "success": {
       "rc": 0
     }
   }


